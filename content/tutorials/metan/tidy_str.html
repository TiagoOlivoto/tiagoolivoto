---
title: Tidy up strings with the R package metan
linktitle: Manipulation
toc: true
type: docs
date: "2019-05-05T00:00:00+01:00"
draft: false
menu:
  example:
    parent: Data Manipulation
    weight: 2
weight: 2
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">
true
</div>

<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>In this quick tip, I show you how to tidy character strings with the package <a href="https://tiagoolivoto.github.io/metan/">metan</a>. If the package is not yet installed, you can download it from <a href="https://cran.r-project.org/web/packages/metan/">CRAN</a>.
Install the released version of metan from <a href="https://CRAN.R-project.org/package=metan">CRAN</a> with:</p>
<pre class="r"><code>install.packages(&quot;metan&quot;)</code></pre>
<p>For the latest release notes on this development version, see the <a href="https://tiagoolivoto.github.io/metan/news/index.html">NEWS file</a>.</p>
<p>Then, load it with:</p>
<pre class="r"><code>library(metan)</code></pre>
</div>
<div id="getting-started-1" class="section level1">
<h1>Getting started</h1>
<p><code>metan</code>â€™s function <a href="https://tiagoolivoto.github.io/metan/reference/utils_num_str.html"><code>tidy_strings()</code></a> can be used to tidy up characters strings by putting all word in upper case, replacing any space, tabulation, punctuation characters by <code>_</code> (underscore), and putting <code>_</code> between lower and upper case.</p>
</div>
<div id="a-simple-example" class="section level1">
<h1>A simple example</h1>
<p>Suppose that we have a character string, say, <code>str = c("Env1", "env 1", "env.1")</code>. By definition <code>str</code> should represent a unique level in plant breeding trials, e.g., environment 1, but in fact it has three levels.</p>
<pre class="r"><code>str &lt;- c(&quot;Env1&quot;, &quot;env 1&quot;, &quot;env.1&quot;)
levels(factor(str))</code></pre>
<pre><code>## [1] &quot;env 1&quot; &quot;env.1&quot; &quot;Env1&quot;</code></pre>
<p>Bad idea!</p>
<p>We can use <a href="https://tiagoolivoto.github.io/metan/reference/utils_num_str.html"><code>tidy_strings()</code></a> to tidy up this string as follows:</p>
<pre class="r"><code>tidy_strings(str)</code></pre>
<pre><code>## [1] &quot;ENV_1&quot; &quot;ENV_1&quot; &quot;ENV_1&quot;</code></pre>
<p>Great! We have now the unique level we should have before.</p>
</div>
<div id="more-examples" class="section level1">
<h1>More examples</h1>
<p>All of the following will be translated into <code>"ENV_1"</code>.</p>
<pre class="r"><code>messy_env &lt;- c(&quot;ENV 1&quot;, &quot;Env   1&quot;, &quot;Env1&quot;, &quot;env1&quot;, &quot;Env.1&quot;, &quot;Env_1&quot;)
tidy_strings(messy_env)</code></pre>
<pre><code>## [1] &quot;ENV_1&quot; &quot;ENV_1&quot; &quot;ENV_1&quot; &quot;ENV_1&quot; &quot;ENV_1&quot; &quot;ENV_1&quot;</code></pre>
<p>All of the following will be translated into <code>"GEN_*"</code>.</p>
<pre class="r"><code>messy_gen &lt;- c(&quot;GEN1&quot;, &quot;gen 2&quot;, &quot;Gen.3&quot;, &quot;gen-4&quot;, &quot;Gen_5&quot;, &quot;GEN_6&quot;)
tidy_strings(messy_gen)</code></pre>
<pre><code>## [1] &quot;GEN_1&quot; &quot;GEN_2&quot; &quot;GEN_3&quot; &quot;GEN_4&quot; &quot;GEN_5&quot; &quot;GEN_6&quot;</code></pre>
<p>All of the following will be translated into <code>"ENV_GEN"</code></p>
<pre class="r"><code>messy_int &lt;- c(&quot;EnvGen&quot;, &quot;Env_Gen&quot;, &quot;env gen&quot;, &quot;Env Gen&quot;, &quot;ENV.GEN&quot;, &quot;ENV_GEN&quot;)
tidy_strings(messy_int)</code></pre>
<pre><code>## [1] &quot;ENV_GEN&quot; &quot;ENV_GEN&quot; &quot;ENV_GEN&quot; &quot;ENV_GEN&quot; &quot;ENV_GEN&quot; &quot;ENV_GEN&quot;</code></pre>
</div>
<div id="tidy-up-a-whole-data-frame" class="section level1">
<h1>Tidy up a whole data frame</h1>
<p>We can also tidy up strings of a whole data frame. By default the separator character is <code>_</code>. To change this default use the argument <code>sep</code>.</p>
<pre class="r"><code>library(tibble)
df &lt;- tibble(Env = messy_env,
             gen = messy_gen,
             Env_Gen = interaction(Env, gen),
             y = rnorm(6, 300, 10))
df</code></pre>
<pre><code>## # A tibble: 6 x 4
##   Env     gen   Env_Gen           y
##   &lt;chr&gt;   &lt;chr&gt; &lt;fct&gt;         &lt;dbl&gt;
## 1 ENV 1   GEN1  ENV 1.GEN1     291.
## 2 Env   1 gen 2 Env   1.gen 2  308.
## 3 Env1    Gen.3 Env1.Gen.3     285.
## 4 env1    gen-4 env1.gen-4     312.
## 5 Env.1   Gen_5 Env.1.Gen_5    306.
## 6 Env_1   GEN_6 Env_1.GEN_6    298.</code></pre>
<pre class="r"><code>tidy_strings(df, sep = &quot;&quot;)</code></pre>
<pre><code>## # A tibble: 6 x 4
##   Env   gen   Env_Gen      y
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;
## 1 ENV1  GEN1  ENV1GEN1  291.
## 2 ENV1  GEN2  ENV1GEN2  308.
## 3 ENV1  GEN3  ENV1GEN3  285.
## 4 ENV1  GEN4  ENV1GEN4  312.
## 5 ENV1  GEN5  ENV1GEN5  306.
## 6 ENV1  GEN6  ENV1GEN6  298.</code></pre>
<p>To select variables to tidy up, simply type the variable name. Here, we also put all column names to upper case</p>
<pre class="r"><code>tidy_strings(df, Env) %&gt;% 
  colnames_to_upper()</code></pre>
<pre><code>## # A tibble: 6 x 4
##   ENV   GEN   ENV_GEN           Y
##   &lt;chr&gt; &lt;chr&gt; &lt;fct&gt;         &lt;dbl&gt;
## 1 ENV_1 GEN1  ENV 1.GEN1     291.
## 2 ENV_1 gen 2 Env   1.gen 2  308.
## 3 ENV_1 Gen.3 Env1.Gen.3     285.
## 4 ENV_1 gen-4 env1.gen-4     312.
## 5 ENV_1 Gen_5 Env.1.Gen_5    306.
## 6 ENV_1 GEN_6 Env_1.GEN_6    298.</code></pre>
</div>
